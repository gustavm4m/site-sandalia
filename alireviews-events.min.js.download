!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["__alr_app__alireviews-events"]=e():t["__alr_app__alireviews-events"]=e()}(self,(function(){return function(){"use strict";var t={},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,r),i.exports}r.d=function(t,e){for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};r.r(n),r.d(n,{default:function(){return z}});var o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;"requestIdleCallback"in window?requestIdleCallback((()=>{t()}),{timeout:e}):setTimeout(t,e)};var i=function(){r.l&&(r.l=(t,e,r,n)=>{var o=document.createElement("script");o.src=t,o.defer=!0,o.async=!1,o.type="text/javascript",o.crossOrigin="anonymous",o.fetchPriority="low",o.onload=()=>e(),o.onerror=r=>{var o=new Error("Loading chunk ".concat(null!=n?n:""," failed: ").concat(t));o.event=r,e(o)},document.body.appendChild(o)})};window.AR_LOCAL_STORAGE=window.AR_LOCAL_STORAGE||{};var a,u=function(t){try{return localStorage.getItem(t)}catch(e){return window.AR_LOCAL_STORAGE[t]||void 0}},c=function(t,e){try{localStorage.setItem(t,e)}catch(r){window.AR_LOCAL_STORAGE[t]=e}return!0};!function(t){t.KDS_LOCAL_USER_TRACKING_ID="KDS_LOCAL_USER_TRACKING_ID",t.KDS_LOCAL_TRACKING_PLACE_ORDER_PRODUCT_ID="KDS_LOCAL_TRACKING_PLACE_ORDER_PRODUCT_ID",t.KDS_LOCAL_TRACKING_ADD_TO_CART_EVENT_STATISTICS="KDS_LOCAL_TRACKING_ADD_TO_CART_EVENT_STATISTICS"}(a||(a={}));var l=()=>{for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",r=0;r<20;r++)e+=t.charAt(Math.floor(62*Math.random()));return e},s=()=>{var t,e,r=u(a.KDS_LOCAL_USER_TRACKING_ID);return r?JSON.parse(r):(e={id:(null===(t=window.__AR_WIDGET_REVIEW_OBJECT)||void 0===t?void 0:t.customer_id)||l(),createdAt:(new Date).toISOString()},c(a.KDS_LOCAL_USER_TRACKING_ID,JSON.stringify(e)),e)},f=()=>{u(a.KDS_LOCAL_TRACKING_PLACE_ORDER_PRODUCT_ID)||c(a.KDS_LOCAL_TRACKING_PLACE_ORDER_PRODUCT_ID,JSON.stringify([]))};function d(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function p(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _(){return"object"==typeof window.__AR_WIDGET_REVIEW_OBJECT?function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?d(Object(r),!0).forEach((function(e){p(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},window.__AR_WIDGET_REVIEW_OBJECT):null}function v(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function y(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){v(i,n,o,a,u,"next",t)}function u(t){v(i,n,o,a,u,"throw",t)}a(void 0)}))}}var O,h,S={baseUrl:"https://pub.kudosi.ai",injectHeaders:(h=y((function*(t){var e,r=_();return t["Content-Type"]="application/json",t["X-Ar-Shopify-Domain"]=null!==(e=null==r?void 0:r.shop_name)&&void 0!==e?e:"",t})),function(t){return h.apply(this,arguments)}),checkResponse:(O=y((function*(t){return t.ok?null:new Error("HTTP error! status: ".concat(t.status," ").concat(t.statusText))})),function(t){return O.apply(this,arguments)})};function b(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function T(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?b(Object(r),!0).forEach((function(e){m(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function m(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function A(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function D(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){A(i,n,o,a,u,"next",t)}function u(t){A(i,n,o,a,u,"throw",t)}a(void 0)}))}}var C=_();function E(t){return w.apply(this,arguments)}function w(){return(w=D((function*(t){var{url:e,data:r,headers:n={},credentials:o="same-origin"}=t,i=function(t){if(t.startsWith("http://")||t.startsWith("https://"))return t;var e=S.baseUrl.replace(/\/$/,""),r=t.startsWith("/")?t:"/".concat(t),{shop_name:n="",shop_id:o=""}=C||{};return"".concat(e).concat(r,"?shop_domain=").concat(n,"&shop_id=").concat(o)}(e);if(navigator.sendBeacon&&r)try{var a,u=JSON.stringify(T(T({},r),{},{shop_id:null!==(a=null==C?void 0:C.shop_id)&&void 0!==a?a:""})),c=navigator.sendBeacon(i,u);return T({success:c,method:"sendBeacon"},c?{}:{error:"sendBeacon failed"})}catch(t){return yield R(i,r,n,o)}return yield R(i,r,n,o)}))).apply(this,arguments)}function R(t,e,r,n){return g.apply(this,arguments)}function g(){return(g=D((function*(t,e,r,n){try{var o="object"==typeof e?JSON.stringify(e):e,i=yield S.injectHeaders(r||{}),a=yield fetch(t,{method:"POST",headers:i,body:o,credentials:n}),u=yield S.checkResponse(a);if(u)throw u;return{success:!0,data:yield a.json().catch((()=>null)),method:"fetch"}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Unknown error",method:"fetch"}}}))).apply(this,arguments)}function I(t,e){return L.apply(this,arguments)}function L(){return(L=D((function*(t,e){return E({url:t,data:e})}))).apply(this,arguments)}var P=()=>{try{var t=u(a.KDS_LOCAL_USER_TRACKING_ID);if(!t)return null;var e=JSON.parse(t);return e&&"string"==typeof e.id&&"string"==typeof e.createdAt?e:null}catch(t){return null}},j=P,N=()=>{try{var t=u(a.KDS_LOCAL_TRACKING_PLACE_ORDER_PRODUCT_ID),e=t?JSON.parse(t):[];if(e.length>0&&"string"==typeof e[0]){var r=e.map((t=>({productId:t,viewDate:(new Date).toISOString()})));return c(a.KDS_LOCAL_TRACKING_PLACE_ORDER_PRODUCT_ID,JSON.stringify(r)),r}return e}catch(t){return[]}};function K(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}var G=_(),k=!1,U=new WeakSet,x=new Map,W=function(){var t,e=(t=function*(t){try{var e=t.toString(),r=Date.now(),n=x.get(e);if(n&&r-n<500)return null;x.set(e,r),x.forEach(((t,e)=>{r-t>6e4&&x.delete(e)}));var o=N().find((t=>t.productId===e));if(o){var{viewDate:i}=o;if(!((t,e)=>{try{var r=new Date(t);return((new Date).getTime()-r.getTime())/864e5>=e}catch(t){return!0}})(i,37))return J(e),null}return null}catch(t){return null}},function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){K(i,n,o,a,u,"next",t)}function u(t){K(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(t){return e.apply(this,arguments)}}(),J=t=>{var e=j(),r=null==e?void 0:e.id;if(r)return(t=>{try{return I("/storefront/trk/add-to-cart",t)}catch(t){return null}})({product_id:parseInt(t),visitor_uuid:r}),!0},V=()=>{var t,e,r,n=document.querySelector("#MainContent");if(n){var o=(t=()=>{B()},e=1e3,function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];clearTimeout(r),r=setTimeout((()=>t.apply(null,o)),e)});new MutationObserver((()=>o())).observe(n,{childList:!0,subtree:!0,attributes:!1})}},B=()=>{var t=document.querySelectorAll('form[action*="/cart/add"]')||[];t.length&&(k=!0,t.forEach((t=>(t=>{var e;if(!U.has(t)){U.add(t);var r=document.createElement("input");r.type="hidden",r.name="properties[_visitor_id]",r.value=(null===(e=j())||void 0===e?void 0:e.id)||"";var n="",o=t.querySelector('input[name="product-id"]');o&&(n=o.value),n||(n=(null==G?void 0:G.product_id)||""),t.appendChild(r),t.addEventListener("submit",(()=>{W(n)}),{capture:!0});var i=t.querySelectorAll('button[type="submit"],input[type="submit"]');i.length&&i.forEach((t=>{t.addEventListener("click",(()=>{W(n)}),{capture:!0})}))}})(t))))},M=()=>{if(!k)try{if(localStorage.getItem(a.KDS_LOCAL_TRACKING_ADD_TO_CART_EVENT_STATISTICS))return;(t=>{try{return I("/storefront/trk/detect-add-event",t)}catch(t){return null}})({}),localStorage.setItem(a.KDS_LOCAL_TRACKING_ADD_TO_CART_EVENT_STATISTICS,"1")}catch(t){}},q=()=>{B(),V(),"product"==(null==G?void 0:G.page_type)&&""!=(null==G?void 0:G.product_id)&&setTimeout((()=>{M()}),1e4)},H=()=>{try{s(),f(),q()}catch(t){}},X=()=>{H()};i();var z=()=>{var t=window;if(!t.__AR_WIDGET_EVENTS){t.__AR_WIDGET_EVENTS=1;o((function(){o((()=>X()),100)}),100)}};return n}()}));